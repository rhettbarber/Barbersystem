<style type="text/css">
    .gallery {
        /*border: #0000ff 1px solid;*/
        display:table;
        width:2590px;
        height:3340px;
        border: 2px solid red;
        text-align:center;
        overflow: hidden;
    }

    .items_category_container {
        border: #0000ff 1px solid;
    }
    .item_reports_categories_footer{
        display:inline-block;
        background-color:#add8e6;
        font-family:"Arial";
        text-align: center;
        font-size:50px;
        width:2550px;
        height:170px;
        overflow: hidden;
    }

    .items_container {
        height: 3165px;
        overflow: hidden;
        display:table;
    }

    .item_specsheet_box {
        page-break-inside: avoid;
        display:inline-block;
        width:860px;
        height:800px;
        font-family:"Arial";
        text-align: center;
        font-size:50px;;
        overflow: hidden;
    }

    .category_header_box {
        width:100%;
        /*height:100px;*/
        background-color: black;
        color:white;
        text-align: center;
        font-size:60px;
        height: 800px;
    }

    .item_specsheet_box img {
        width:700px;
        max-height:700px;
    }

    .categories_container {
    }

    .item_reports_categories_footer_categories{
        width:2400px;
        float: left;
        height:170px;
        overflow: hidden;
    }

    .item_reports_categories_footer_pagenumber{
        width:150px;
        float: right;
        font-family:"Arial Black";
        text-align: center;
        font-size:100px;
        height:170px;
        overflow: hidden;
    }

</style>



<div class="categories_container">
  <div class="gallery">  <%=  image_tag( "/images/automated-catalog/" +   Slug.generate( @catalog.name )   + "-front-cover.jpg") %> </div>
  <div class="gallery">  <%=  image_tag( "/images/automated-catalog/front-cover-inside.jpg") %> </div>
  <% page_number  = 0 %>
  <%# already_seen_category_ids  = Set.new %>
  <%   @items.each_slice(12) do |slice|  %>
      <% @categories_this_page = Set.new   %>
      <% page_number  += 1  %>
      <div class="gallery">



        <div class="items_container">
          <% slice.each do |item|   %>
                              <%# if  !already_seen_category_ids.include?(  item.category_id.to_s  ) and @catalog.category_ids_with_header.include? item.category_id.to_s   %>
                                             <!--<div class="category_header_box">-->
                                                            <!--<%#= image_tag(  "/images/automated-catalog/headers/" +   Slug.generate( item.category.Name ) + ".jpg" ) %>-->
                                                           <!--Barber and Company designs and manufactures a collection of shirts printed All Over for Key West <br>-->
                                                           <!--<br>-->
                                                           <!--Shirts are available in 50/50 (cotton/polyester)  or 100%  polyester and are printed all over using sublimation inks.-->
                                                           <!--These inks become part of the shirt fibers when printed and the shirt has no ink feel. Air can circulate freely-->
                                                           <!--through all areas of the shirt. There is a 6 pc. minimum per design.  Specify sizes. Price is $10.00 each, S-XL-->
                                             <!--</div>-->
                              <%# end %>
                             <%#  already_seen_category_ids.add(  item.category_id.to_s  )  %>
              <div class="item_specsheet_box">
                                            <% cat_array = [] %>
                                            <% @categories_this_page.add(  cat_array << [ item.department.Name.capitalize,  item.category.Name.capitalize ]  )    %>
                                            <%=  image_tag( item.image_url( item.department, 'item_thumbnails/','x'  ) ) %><br />
                                            <%=  item.ItemLookupCode   %> <%=  item.minimum_quantity_message   %>
                              </div>
          <% end %>
        </div>
        <div class="item_reports_categories_footer">
          <div class="item_reports_categories_footer_categories">
            <% already_seen_departments = Set.new %>
            <% iterations = 0.0 %>

            <%  @categories_this_page.each do  |this_pages_category|  %>

                <%  if this_pages_category %>


                    <% this_pages_category.each do |tpc| %>
                        <% the_department =  tpc[0] %>
                        <% the_category =   tpc[1] %>
                        <% if already_seen_departments.include?(the_department)   %>

                            , &nbsp;

                            <%=  the_category.gsub( the_department , "")   %>
                        <% else %>
                            &nbsp;  &nbsp;  &nbsp;
                            <% already_seen_departments.add( the_department ) %>

                            <%    the_department_name_to_gsub =   "-"  + the_department   %>
                            <%    the_category_name_to_gsub =   "-"  + the_category   %>

                            <strong><%=  the_department  %></strong> <%=  the_category_name_to_gsub.gsub( the_department_name_to_gsub , "" )  %>
                        <% end %>


                    <% end %>

                <% end %>

            <% end %>
          </div>
          <div class="item_reports_categories_footer_pagenumber">
            <%= page_number  %>
          </div>


        </div>
      </div>
  <% end %>
  <div class="gallery">  <%=  image_tag( "/images/automated-catalog/back-cover-inside.jpg") %> </div>
  <!--<div class="gallery">  <%#=  image_tag( "/images/automated-catalog/back-cover.jpg") %> </div>-->
  <div class="gallery">  <%=  image_tag( "/images/automated-catalog/order-form.jpg") %> </div>
</div>



